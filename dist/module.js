define(["react","lodash","@grafana/ui","@grafana/data","@grafana/runtime"],(function(e,t,n,r,o){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=75)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){e.exports=n(57)()},function(e,t,n){"use strict";e.exports=n(56).default},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(16),o=n(34),i=n(35),u=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?o(e):i(e)}},function(e,t,n){var r=n(17),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t,n){var r=n(15),o=n(19);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e===t)return!1;var o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!0;var u,a,s={};for(u=0,a=n.length;u<a;u++)s[n[u]]=!0;for(u=0,a=o.length;u<a;u++){var c=o[u],l=e[c],f=t[c];if(l!==f){if(!s[c]||null===l||null===f||"object"!==r(l)||"object"!==r(f))return!0;var p=Object.keys(l),g=Object.keys(f);if(p.length!==g.length)return!0;for(var d=0,h=p.length;d<h;d++){var m=p[d];if(l[m]!==f[m])return!0}}}return!1}},function(e,t,n){var r=n(14),o=n(25),i=n(27);e.exports=function(e,t){return i(o(e,t,r),e+"")}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(9),o=n(7);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var r=n(10).Symbol;e.exports=r},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(33))},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(13),o=n(18),i=n(41),u=n(42),a=Object.prototype,s=a.hasOwnProperty,c=r((function(e,t){e=Object(e);var n=-1,r=t.length,c=r>2?t[2]:void 0;for(c&&i(t[0],t[1],c)&&(r=1);++n<r;)for(var l=t[n],f=u(l),p=-1,g=f.length;++p<g;){var d=f[p],h=e[d];(void 0===h||o(h,a[d])&&!s.call(e,d))&&(e[d]=l[d])}return e}));e.exports=c},function(e,t,n){var r=n(13)(n(68));e.exports=r},function(e,t,n){var r=n(26),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,u=-1,a=o(i.length-t,0),s=Array(a);++u<a;)s[u]=i[t+u];u=-1;for(var c=Array(t+1);++u<t;)c[u]=i[u];return c[t]=n(s),r(e,this,c)}}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(28),o=n(40)(r);e.exports=o},function(e,t,n){var r=n(29),o=n(30),i=n(14),u=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=u},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(31),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r=n(32),o=n(39);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(15),o=n(36),i=n(7),u=n(38),a=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,l=s.toString,f=c.hasOwnProperty,p=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?p:a).test(u(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(16),o=Object.prototype,i=o.hasOwnProperty,u=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=u.call(e);return r&&(t?e[a]=n:delete e[a]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,o=n(37),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!i&&i in e}},function(e,t,n){var r=n(10)["__core-js_shared__"];e.exports=r},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var o=n(),i=16-(o-r);if(r=o,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(18),o=n(11),i=n(20),u=n(7);e.exports=function(e,t,n){if(!u(n))return!1;var a=typeof t;return!!("number"==a?o(n)&&i(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(43),o=n(53),i=n(11);e.exports=function(e){return i(e)?r(e,!0):o(e)}},function(e,t,n){var r=n(21),o=n(44),i=n(46),u=n(47),a=n(20),s=n(49),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),l=!n&&o(e),f=!n&&!l&&u(e),p=!n&&!l&&!f&&s(e),g=n||l||f||p,d=g?r(e.length,String):[],h=d.length;for(var m in e)!t&&!c.call(e,m)||g&&("length"==m||f&&("offset"==m||"parent"==m)||p&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,h))||d.push(m);return d}},function(e,t,n){var r=n(45),o=n(8),i=Object.prototype,u=i.hasOwnProperty,a=i.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(e){return o(e)&&u.call(e,"callee")&&!a.call(e,"callee")};e.exports=s},function(e,t,n){var r=n(9),o=n(8);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){(function(e){var r=n(10),o=n(48),i=t&&!t.nodeType&&t,u=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=u&&u.exports===i?r.Buffer:void 0,s=(a?a.isBuffer:void 0)||o;e.exports=s}).call(this,n(22)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(50),o=n(51),i=n(52),u=i&&i.isTypedArray,a=u?o(u):r;e.exports=a},function(e,t,n){var r=n(9),o=n(19),i=n(8),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!u[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(17),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,u=i&&i.exports===o&&r.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||u&&u.binding&&u.binding("util")}catch(e){}}();e.exports=a}).call(this,n(22)(e))},function(e,t,n){var r=n(7),o=n(54),i=n(55),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&u.call(e,a))&&n.push(a);return n}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(0)),o=s(n(5)),i=s(n(59)),u=s(n(60)),a=n(67);function s(e){return e&&e.__esModule?e:{default:e}}function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(){return!0},w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(l,e);var t,n,o,s,c=(t=l,function(){var e,n=y(t);if(m()){var r=y(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return d(this,e)});function l(e){var t,n=e.alwaysRenderSuggestions;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),b(h(t=c.call(this)),"onDocumentMouseDown",(function(e){t.justClickedOnSuggestionsContainer=!1;for(var n=e.detail&&e.detail.target||e.target;null!==n&&n!==document;){if(n.getAttribute&&null!==n.getAttribute("data-suggestion-index"))return;if(n===t.suggestionsContainer)return void(t.justClickedOnSuggestionsContainer=!0);n=n.parentNode}})),b(h(t),"storeAutowhateverRef",(function(e){null!==e&&(t.autowhatever=e)})),b(h(t),"onSuggestionMouseEnter",(function(e,n){var r=n.sectionIndex,o=n.itemIndex;t.updateHighlightedSuggestion(r,o),e.target===t.pressedSuggestion&&(t.justSelectedSuggestion=!0),t.justMouseEntered=!0,setTimeout((function(){t.justMouseEntered=!1}))})),b(h(t),"highlightFirstSuggestion",(function(){t.updateHighlightedSuggestion(t.props.multiSection?0:null,0)})),b(h(t),"onDocumentMouseUp",(function(){t.pressedSuggestion&&!t.justSelectedSuggestion&&t.input.focus(),t.pressedSuggestion=null})),b(h(t),"onSuggestionMouseDown",(function(e){t.justSelectedSuggestion||(t.justSelectedSuggestion=!0,t.pressedSuggestion=e.target)})),b(h(t),"onSuggestionsClearRequested",(function(){var e=t.props.onSuggestionsClearRequested;e&&e()})),b(h(t),"onSuggestionSelected",(function(e,n){var r=t.props,o=r.alwaysRenderSuggestions,i=r.onSuggestionSelected,u=r.onSuggestionsFetchRequested;i&&i(e,n),o?u({value:n.suggestionValue,reason:"suggestion-selected"}):t.onSuggestionsClearRequested(),t.resetHighlightedSuggestion()})),b(h(t),"onSuggestionClick",(function(e){var n=t.props,r=n.alwaysRenderSuggestions,o=n.focusInputOnSuggestionClick,i=t.getSuggestionIndices(t.findSuggestionElement(e.target)),u=i.sectionIndex,a=i.suggestionIndex,s=t.getSuggestion(u,a),c=t.props.getSuggestionValue(s);t.maybeCallOnChange(e,c,"click"),t.onSuggestionSelected(e,{suggestion:s,suggestionValue:c,suggestionIndex:a,sectionIndex:u,method:"click"}),r||t.closeSuggestions(),!0===o?t.input.focus():t.onBlur(),setTimeout((function(){t.justSelectedSuggestion=!1}))})),b(h(t),"onBlur",(function(){var e=t.props,n=e.inputProps,r=e.shouldRenderSuggestions,o=n.value,i=n.onBlur,u=t.getHighlightedSuggestion(),a=r(o);t.setState({isFocused:!1,highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null,isCollapsed:!a}),i&&i(t.blurEvent,{highlightedSuggestion:u})})),b(h(t),"onSuggestionMouseLeave",(function(e){t.resetHighlightedSuggestion(!1),t.justSelectedSuggestion&&e.target===t.pressedSuggestion&&(t.justSelectedSuggestion=!1)})),b(h(t),"onSuggestionTouchStart",(function(){t.justSelectedSuggestion=!0})),b(h(t),"onSuggestionTouchMove",(function(){t.justSelectedSuggestion=!1,t.pressedSuggestion=null,t.input.focus()})),b(h(t),"itemProps",(function(e){return{"data-section-index":e.sectionIndex,"data-suggestion-index":e.itemIndex,onMouseEnter:t.onSuggestionMouseEnter,onMouseLeave:t.onSuggestionMouseLeave,onMouseDown:t.onSuggestionMouseDown,onTouchStart:t.onSuggestionTouchStart,onTouchMove:t.onSuggestionTouchMove,onClick:t.onSuggestionClick}})),b(h(t),"renderSuggestionsContainer",(function(e){var n=e.containerProps,r=e.children;return(0,t.props.renderSuggestionsContainer)({containerProps:n,children:r,query:t.getQuery()})})),t.state={isFocused:!1,isCollapsed:!n,highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null},t.justPressedUpDown=!1,t.justMouseEntered=!1,t.pressedSuggestion=null,t}return n=l,(o=[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onDocumentMouseDown),document.addEventListener("mouseup",this.onDocumentMouseUp),this.input=this.autowhatever.input,this.suggestionsContainer=this.autowhatever.itemsContainer}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){(0,i.default)(e.suggestions,this.props.suggestions)?e.highlightFirstSuggestion&&e.suggestions.length>0&&!1===this.justPressedUpDown&&!1===this.justMouseEntered&&this.highlightFirstSuggestion():this.willRenderSuggestions(e)?this.state.isCollapsed&&!this.justSelectedSuggestion&&this.revealSuggestions():this.resetHighlightedSuggestion()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.suggestions,o=n.onSuggestionHighlighted,u=n.highlightFirstSuggestion;if(!(0,i.default)(r,e.suggestions)&&r.length>0&&u)this.highlightFirstSuggestion();else if(o){var a=this.getHighlightedSuggestion();a!=t.highlightedSuggestion&&o({suggestion:a})}}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onDocumentMouseDown),document.removeEventListener("mouseup",this.onDocumentMouseUp)}},{key:"updateHighlightedSuggestion",value:function(e,t,n){var r=this;this.setState((function(o){var i=o.valueBeforeUpDown;return null===t?i=null:null===i&&void 0!==n&&(i=n),{highlightedSectionIndex:e,highlightedSuggestionIndex:t,highlightedSuggestion:null===t?null:r.getSuggestion(e,t),valueBeforeUpDown:i}}))}},{key:"resetHighlightedSuggestion",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState((function(t){var n=t.valueBeforeUpDown;return{highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:e?null:n}}))}},{key:"revealSuggestions",value:function(){this.setState({isCollapsed:!1})}},{key:"closeSuggestions",value:function(){this.setState({highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null,isCollapsed:!0})}},{key:"getSuggestion",value:function(e,t){var n=this.props,r=n.suggestions,o=n.multiSection,i=n.getSectionSuggestions;return o?i(r[e])[t]:r[t]}},{key:"getHighlightedSuggestion",value:function(){var e=this.state,t=e.highlightedSectionIndex,n=e.highlightedSuggestionIndex;return null===n?null:this.getSuggestion(t,n)}},{key:"getSuggestionValueByIndex",value:function(e,t){return(0,this.props.getSuggestionValue)(this.getSuggestion(e,t))}},{key:"getSuggestionIndices",value:function(e){var t=e.getAttribute("data-section-index"),n=e.getAttribute("data-suggestion-index");return{sectionIndex:"string"==typeof t?parseInt(t,10):null,suggestionIndex:parseInt(n,10)}}},{key:"findSuggestionElement",value:function(e){var t=e;do{if(t.getAttribute&&null!==t.getAttribute("data-suggestion-index"))return t;t=t.parentNode}while(null!==t);throw console.error("Clicked element:",e),new Error("Couldn't find suggestion element")}},{key:"maybeCallOnChange",value:function(e,t,n){var r=this.props.inputProps,o=r.value,i=r.onChange;t!==o&&i(e,{newValue:t,method:n})}},{key:"willRenderSuggestions",value:function(e){var t=e.suggestions,n=e.inputProps,r=e.shouldRenderSuggestions,o=n.value;return t.length>0&&r(o)}},{key:"getQuery",value:function(){var e=this.props.inputProps.value,t=this.state.valueBeforeUpDown;return(null===t?e:t).trim()}},{key:"render",value:function(){var e=this,t=this.props,n=t.suggestions,o=t.renderInputComponent,i=t.onSuggestionsFetchRequested,s=t.renderSuggestion,c=t.inputProps,l=t.multiSection,f=t.renderSectionTitle,g=t.id,d=t.getSectionSuggestions,h=t.theme,m=t.getSuggestionValue,y=t.alwaysRenderSuggestions,v=t.highlightFirstSuggestion,b=this.state,w=b.isFocused,O=b.isCollapsed,P=b.highlightedSectionIndex,j=b.highlightedSuggestionIndex,x=b.valueBeforeUpDown,I=y?S:this.props.shouldRenderSuggestions,C=c.value,_=c.onFocus,R=c.onKeyDown,E=this.willRenderSuggestions(this.props),k=y||w&&!O&&E,D=k?n:[],F=p({},c,{onFocus:function(t){if(!e.justSelectedSuggestion&&!e.justClickedOnSuggestionsContainer){var n=I(C);e.setState({isFocused:!0,isCollapsed:!n}),_&&_(t),n&&i({value:C,reason:"input-focused"})}},onBlur:function(t){e.justClickedOnSuggestionsContainer?e.input.focus():(e.blurEvent=t,e.justSelectedSuggestion||(e.onBlur(),e.onSuggestionsClearRequested()))},onChange:function(t){var n=t.target.value,r=I(n);e.maybeCallOnChange(t,n,"type"),e.suggestionsContainer&&(e.suggestionsContainer.scrollTop=0),e.setState(p({},v?{}:{highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null},{valueBeforeUpDown:null,isCollapsed:!r})),r?i({value:n,reason:"input-changed"}):e.onSuggestionsClearRequested()},onKeyDown:function(t,r){var o=t.keyCode;switch(o){case 40:case 38:if(O)I(C)&&(i({value:C,reason:"suggestions-revealed"}),e.revealSuggestions());else if(n.length>0){var u,a=r.newHighlightedSectionIndex,s=r.newHighlightedItemIndex;u=null===s?null===x?C:x:e.getSuggestionValueByIndex(a,s),e.updateHighlightedSuggestion(a,s,C),e.maybeCallOnChange(t,u,40===o?"down":"up")}t.preventDefault(),e.justPressedUpDown=!0,setTimeout((function(){e.justPressedUpDown=!1}));break;case 13:if(229===t.keyCode)break;var c=e.getHighlightedSuggestion();if(k&&!y&&e.closeSuggestions(),null!=c){var l=m(c);e.maybeCallOnChange(t,l,"enter"),e.onSuggestionSelected(t,{suggestion:c,suggestionValue:l,suggestionIndex:j,sectionIndex:P,method:"enter"}),e.justSelectedSuggestion=!0,setTimeout((function(){e.justSelectedSuggestion=!1}))}break;case 27:k&&t.preventDefault();var f=k&&!y;null===x?f||(e.maybeCallOnChange(t,"","escape"),I("")?i({value:"",reason:"escape-pressed"}):e.onSuggestionsClearRequested()):e.maybeCallOnChange(t,x,"escape"),f?(e.onSuggestionsClearRequested(),e.closeSuggestions()):e.resetHighlightedSuggestion()}R&&R(t)}}),M={query:this.getQuery()};return r.default.createElement(u.default,{multiSection:l,items:D,renderInputComponent:o,renderItemsContainer:this.renderSuggestionsContainer,renderItem:s,renderItemData:M,renderSectionTitle:f,getSectionItems:d,highlightedSectionIndex:P,highlightedItemIndex:j,inputProps:F,itemProps:this.itemProps,theme:(0,a.mapToAutowhateverTheme)(h),id:g,ref:this.storeAutowhateverRef})}}])&&g(n.prototype,o),s&&g(n,s),l}(r.Component);t.default=w,b(w,"propTypes",{suggestions:o.default.array.isRequired,onSuggestionsFetchRequested:function(e,t){var n=e[t];if("function"!=typeof n)throw new Error("'onSuggestionsFetchRequested' must be implemented. See: https://github.com/moroshko/react-autosuggest#onSuggestionsFetchRequestedProp")},onSuggestionsClearRequested:function(e,t){var n=e[t];if(!1===e.alwaysRenderSuggestions&&"function"!=typeof n)throw new Error("'onSuggestionsClearRequested' must be implemented. See: https://github.com/moroshko/react-autosuggest#onSuggestionsClearRequestedProp")},onSuggestionSelected:o.default.func,onSuggestionHighlighted:o.default.func,renderInputComponent:o.default.func,renderSuggestionsContainer:o.default.func,getSuggestionValue:o.default.func.isRequired,renderSuggestion:o.default.func.isRequired,inputProps:function(e,t){var n=e[t];if(!Object.prototype.hasOwnProperty.call(n,"value"))throw new Error("'inputProps' must have 'value'.");if(!Object.prototype.hasOwnProperty.call(n,"onChange"))throw new Error("'inputProps' must have 'onChange'.")},shouldRenderSuggestions:o.default.func,alwaysRenderSuggestions:o.default.bool,multiSection:o.default.bool,renderSectionTitle:function(e,t){var n=e[t];if(!0===e.multiSection&&"function"!=typeof n)throw new Error("'renderSectionTitle' must be implemented. See: https://github.com/moroshko/react-autosuggest#renderSectionTitleProp")},getSectionSuggestions:function(e,t){var n=e[t];if(!0===e.multiSection&&"function"!=typeof n)throw new Error("'getSectionSuggestions' must be implemented. See: https://github.com/moroshko/react-autosuggest#getSectionSuggestionsProp")},focusInputOnSuggestionClick:o.default.bool,highlightFirstSuggestion:o.default.bool,theme:o.default.object,id:o.default.string}),b(w,"defaultProps",{renderSuggestionsContainer:function(e){var t=e.containerProps,n=e.children;return r.default.createElement("div",t,n)},shouldRenderSuggestions:function(e){return e.trim().length>0},alwaysRenderSuggestions:!1,multiSection:!1,focusInputOnSuggestionClick:!0,highlightFirstSuggestion:!1,theme:a.defaultTheme,id:"1"})},function(e,t,n){"use strict";var r=n(58);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,u){if(u!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";e.exports=function(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==h(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(0)),o=c(n(5)),i=c(n(61)),u=c(n(62)),a=c(n(64)),s=c(n(65));function c(e){return e&&e.__esModule?e:{default:e}}function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P={},j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(f,e);var t,n,o,c,l=(t=f,function(){var e,n=S(t);if(b()){var r=S(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return y(this,e)});function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),O(v(t=l.call(this,e)),"storeInputReference",(function(e){null!==e&&(t.input=e);var n=t.props.inputProps.ref;n&&("function"==typeof n?n(e):"object"===h(n)&&Object.prototype.hasOwnProperty.call(n,"current")&&(n.current=e))})),O(v(t),"storeItemsContainerReference",(function(e){null!==e&&(t.itemsContainer=e)})),O(v(t),"onHighlightedItemChange",(function(e){t.highlightedItem=e})),O(v(t),"getItemId",(function(e,n){if(null===n)return null;var r=t.props.id,o=null===e?"":"section-".concat(e);return"react-autowhatever-".concat(r,"-").concat(o,"-item-").concat(n)})),O(v(t),"onFocus",(function(e){var n=t.props.inputProps;t.setState({isInputFocused:!0}),n.onFocus&&n.onFocus(e)})),O(v(t),"onBlur",(function(e){var n=t.props.inputProps;t.setState({isInputFocused:!1}),n.onBlur&&n.onBlur(e)})),O(v(t),"onKeyDown",(function(e){var n=t.props,r=n.inputProps,o=n.highlightedSectionIndex,i=n.highlightedItemIndex;switch(e.key){case"ArrowDown":case"ArrowUp":var u="ArrowDown"===e.key?"next":"prev",a=g(t.sectionIterator[u]([o,i]),2),s=a[0],c=a[1];r.onKeyDown(e,{newHighlightedSectionIndex:s,newHighlightedItemIndex:c});break;default:r.onKeyDown(e,{highlightedSectionIndex:o,highlightedItemIndex:i})}})),t.highlightedItem=null,t.state={isInputFocused:!1},t.setSectionsItems(e),t.setSectionIterator(e),t.setTheme(e),t}return n=f,(o=[{key:"componentDidMount",value:function(){this.ensureHighlightedItemIsVisible()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.items!==this.props.items&&this.setSectionsItems(e),e.items===this.props.items&&e.multiSection===this.props.multiSection||this.setSectionIterator(e),e.theme!==this.props.theme&&this.setTheme(e)}},{key:"componentDidUpdate",value:function(){this.ensureHighlightedItemIsVisible()}},{key:"setSectionsItems",value:function(e){e.multiSection&&(this.sectionsItems=e.items.map((function(t){return e.getSectionItems(t)})),this.sectionsLengths=this.sectionsItems.map((function(e){return e.length})),this.allSectionsAreEmpty=this.sectionsLengths.every((function(e){return 0===e})))}},{key:"setSectionIterator",value:function(e){this.sectionIterator=(0,i.default)({multiSection:e.multiSection,data:e.multiSection?this.sectionsLengths:e.items.length})}},{key:"setTheme",value:function(e){this.theme=(0,u.default)(e.theme)}},{key:"renderSections",value:function(){var e=this;if(this.allSectionsAreEmpty)return null;var t=this.theme,n=this.props,o=n.id,i=n.items,u=n.renderItem,c=n.renderItemData,l=n.renderSectionTitle,f=n.highlightedSectionIndex,p=n.highlightedItemIndex,g=n.itemProps;return i.map((function(n,i){var d="react-autowhatever-".concat(o,"-"),h="".concat(d,"section-").concat(i,"-"),m=0===i;return r.default.createElement("div",t("".concat(h,"container"),"sectionContainer",m&&"sectionContainerFirst"),r.default.createElement(a.default,{section:n,renderSectionTitle:l,theme:t,sectionKeyPrefix:h}),r.default.createElement(s.default,{items:e.sectionsItems[i],itemProps:g,renderItem:u,renderItemData:c,sectionIndex:i,highlightedItemIndex:f===i?p:null,onHighlightedItemChange:e.onHighlightedItemChange,getItemId:e.getItemId,theme:t,keyPrefix:d,ref:e.storeItemsListReference}))}))}},{key:"renderItems",value:function(){var e=this.props.items;if(0===e.length)return null;var t=this.theme,n=this.props,o=n.id,i=n.renderItem,u=n.renderItemData,a=n.highlightedSectionIndex,c=n.highlightedItemIndex,l=n.itemProps;return r.default.createElement(s.default,{items:e,itemProps:l,renderItem:i,renderItemData:u,highlightedItemIndex:null===a?c:null,onHighlightedItemChange:this.onHighlightedItemChange,getItemId:this.getItemId,theme:t,keyPrefix:"react-autowhatever-".concat(o,"-")})}},{key:"ensureHighlightedItemIsVisible",value:function(){var e=this.highlightedItem;if(e){var t=this.itemsContainer,n=e.offsetParent===t?e.offsetTop:e.offsetTop-t.offsetTop,r=t.scrollTop;n<r?r=n:n+e.offsetHeight>r+t.offsetHeight&&(r=n+e.offsetHeight-t.offsetHeight),r!==t.scrollTop&&(t.scrollTop=r)}}},{key:"render",value:function(){var e=this.theme,t=this.props,n=t.id,o=t.multiSection,i=t.renderInputComponent,u=t.renderItemsContainer,a=t.highlightedSectionIndex,s=t.highlightedItemIndex,c=this.state.isInputFocused,l=o?this.renderSections():this.renderItems(),f=null!==l,g=this.getItemId(a,s),d="react-autowhatever-".concat(n),h=p({role:"combobox","aria-haspopup":"listbox","aria-owns":d,"aria-expanded":f},e("react-autowhatever-".concat(n,"-container"),"container",f&&"containerOpen"),{},this.props.containerProps),m=i(p({type:"text",value:"",autoComplete:"off","aria-autocomplete":"list","aria-controls":d,"aria-activedescendant":g},e("react-autowhatever-".concat(n,"-input"),"input",f&&"inputOpen",c&&"inputFocused"),{},this.props.inputProps,{onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.props.inputProps.onKeyDown&&this.onKeyDown,ref:this.storeInputReference})),y=u({containerProps:p({id:d,role:"listbox"},e("react-autowhatever-".concat(n,"-items-container"),"itemsContainer",f&&"itemsContainerOpen"),{ref:this.storeItemsContainerReference}),children:l});return r.default.createElement("div",h,m,y)}}])&&m(n.prototype,o),c&&m(n,c),f}(r.Component);t.default=j,O(j,"propTypes",{id:o.default.string,multiSection:o.default.bool,renderInputComponent:o.default.func,renderItemsContainer:o.default.func,items:o.default.array.isRequired,renderItem:o.default.func,renderItemData:o.default.object,renderSectionTitle:o.default.func,getSectionItems:o.default.func,containerProps:o.default.object,inputProps:o.default.object,itemProps:o.default.oneOfType([o.default.object,o.default.func]),highlightedSectionIndex:o.default.number,highlightedItemIndex:o.default.number,theme:o.default.oneOfType([o.default.object,o.default.array])}),O(j,"defaultProps",{id:"1",multiSection:!1,renderInputComponent:function(e){return r.default.createElement("input",e)},renderItemsContainer:function(e){var t=e.containerProps,n=e.children;return r.default.createElement("div",t,n)},renderItem:function(){throw new Error("`renderItem` must be provided")},renderItemData:P,renderSectionTitle:function(){throw new Error("`renderSectionTitle` must be provided")},getSectionItems:function(){throw new Error("`getSectionItems` must be provided")},containerProps:P,inputProps:P,itemProps:P,highlightedSectionIndex:null,highlightedItemIndex:null,theme:{container:"react-autowhatever__container",containerOpen:"react-autowhatever__container--open",input:"react-autowhatever__input",inputOpen:"react-autowhatever__input--open",inputFocused:"react-autowhatever__input--focused",itemsContainer:"react-autowhatever__items-container",itemsContainerOpen:"react-autowhatever__items-container--open",itemsList:"react-autowhatever__items-list",item:"react-autowhatever__item",itemFirst:"react-autowhatever__item--first",itemHighlighted:"react-autowhatever__item--highlighted",sectionContainer:"react-autowhatever__section-container",sectionContainerFirst:"react-autowhatever__section-container--first",sectionTitle:"react-autowhatever__section-title"}})},function(e,t,n){"use strict";var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.exports=function(e){var t=e.data,n=e.multiSection;function o(e){var o=r(e,2),i=o[0],u=o[1];return n?null===u||u===t[i]-1?null===(i=function(e){for(null===e?e=0:e++;e<t.length&&0===t[e];)e++;return e===t.length?null:e}(i))?[null,null]:[i,0]:[i,u+1]:0===t||u===t-1?[null,null]:null===u?[null,0]:[null,u+1]}return{next:o,prev:function(e){var o=r(e,2),i=o[0],u=o[1];return n?null===u||0===u?null===(i=function(e){for(null===e?e=t.length-1:e--;e>=0&&0===t[e];)e--;return-1===e?null:e}(i))?[null,null]:[i,t[i]-1]:[i,u-1]:0===t||0===u?[null,null]:null===u?[null,t-1]:[null,u-1]},isLast:function(e){return null===o(e)[1]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i,u=n(63),a=(i=u)&&i.__esModule?i:{default:i},s=function(e){return e};t.default=function(e){var t=Array.isArray(e)&&2===e.length?e:[e,null],n=r(t,2),i=n[0],u=n[1];return function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var c=n.map((function(e){return i[e]})).filter(s);return"string"==typeof c[0]||"function"==typeof u?{key:e,className:u?u.apply(void 0,o(c)):c.join(" ")}:{key:e,style:a.default.apply(void 0,[{}].concat(o(c)))}}},e.exports=t.default},function(e,t,n){"use strict";var r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function i(e){var t=Object.getOwnPropertyNames(e);return Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t.filter((function(t){return r.call(e,t)}))}e.exports=Object.assign||function(e,t){for(var n,r,u=o(e),a=1;a<arguments.length;a++){n=arguments[a],r=i(Object(n));for(var s=0;s<r.length;s++)u[r[s]]=n[r[s]]}return u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(0)),o=u(n(5)),i=u(n(12));function u(e){return e&&e.__esModule?e:{default:e}}function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h,m,y,v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(s,e);var t,n,o,u,a=(t=s,function(){var e,n=g(t);if(p()){var r=g(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return f(this,e)});function s(){return c(this,s),a.apply(this,arguments)}return n=s,(o=[{key:"shouldComponentUpdate",value:function(e){return(0,i.default)(e,this.props)}},{key:"render",value:function(){var e=this.props,t=e.section,n=e.renderSectionTitle,o=e.theme,i=e.sectionKeyPrefix,u=n(t);return u?r.default.createElement("div",o("".concat(i,"title"),"sectionTitle"),u):null}}])&&l(n.prototype,o),u&&l(n,u),s}(r.Component);t.default=v,h=v,m="propTypes",y={section:o.default.any.isRequired,renderSectionTitle:o.default.func.isRequired,theme:o.default.func.isRequired,sectionKeyPrefix:o.default.string.isRequired},m in h?Object.defineProperty(h,m,{value:y,enumerable:!0,configurable:!0,writable:!0}):h[m]=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(0)),o=a(n(5)),i=a(n(66)),u=a(n(12));function a(e){return e&&e.__esModule?e:{default:e}}function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(c,e);var t,n,o,a,s=(t=c,function(){var e,n=y(t);if(m()){var r=y(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return d(this,e)});function c(){var e;p(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b(h(e=s.call.apply(s,[this].concat(n))),"storeHighlightedItemReference",(function(t){e.props.onHighlightedItemChange(null===t?null:t.item)})),e}return n=c,(o=[{key:"shouldComponentUpdate",value:function(e){return(0,u.default)(e,this.props,["itemProps"])}},{key:"render",value:function(){var e=this,t=this.props,n=t.items,o=t.itemProps,u=t.renderItem,a=t.renderItemData,s=t.sectionIndex,c=t.highlightedItemIndex,p=t.getItemId,g=t.theme,d=t.keyPrefix,h=null===s?d:"".concat(d,"section-").concat(s,"-"),m="function"==typeof o;return r.default.createElement("ul",l({role:"listbox"},g("".concat(h,"items-list"),"itemsList")),n.map((function(t,n){var d=0===n,y=n===c,v="".concat(h,"item-").concat(n),S=m?o({sectionIndex:s,itemIndex:n}):o,w=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:p(s,n),"aria-selected":y},g(v,"item",d&&"itemFirst",y&&"itemHighlighted"),{},S);return y&&(w.ref=e.storeHighlightedItemReference),r.default.createElement(i.default,l({},w,{sectionIndex:s,isHighlighted:y,itemIndex:n,item:t,renderItem:u,renderItemData:a}))})))}}])&&g(n.prototype,o),a&&g(n,a),c}(r.Component);t.default=S,b(S,"propTypes",{items:o.default.array.isRequired,itemProps:o.default.oneOfType([o.default.object,o.default.func]),renderItem:o.default.func.isRequired,renderItemData:o.default.object.isRequired,sectionIndex:o.default.number,highlightedItemIndex:o.default.number,onHighlightedItemChange:o.default.func.isRequired,getItemId:o.default.func.isRequired,theme:o.default.func.isRequired,keyPrefix:o.default.string.isRequired}),b(S,"defaultProps",{sectionIndex:null})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(0)),o=u(n(5)),i=u(n(12));function u(e){return e&&e.__esModule?e:{default:e}}function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(s,e);var t,n,o,u,a=(t=s,function(){var e,n=y(t);if(m()){var r=y(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return d(this,e)});function s(){var e;p(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b(h(e=a.call.apply(a,[this].concat(n))),"storeItemReference",(function(t){null!==t&&(e.item=t)})),b(h(e),"onMouseEnter",(function(t){var n=e.props,r=n.sectionIndex,o=n.itemIndex;e.props.onMouseEnter(t,{sectionIndex:r,itemIndex:o})})),b(h(e),"onMouseLeave",(function(t){var n=e.props,r=n.sectionIndex,o=n.itemIndex;e.props.onMouseLeave(t,{sectionIndex:r,itemIndex:o})})),b(h(e),"onMouseDown",(function(t){var n=e.props,r=n.sectionIndex,o=n.itemIndex;e.props.onMouseDown(t,{sectionIndex:r,itemIndex:o})})),b(h(e),"onClick",(function(t){var n=e.props,r=n.sectionIndex,o=n.itemIndex;e.props.onClick(t,{sectionIndex:r,itemIndex:o})})),e}return n=s,(o=[{key:"shouldComponentUpdate",value:function(e){return(0,i.default)(e,this.props,["renderItemData"])}},{key:"render",value:function(){var e=this.props,t=e.isHighlighted,n=e.item,o=e.renderItem,i=e.renderItemData,u=f(e,["isHighlighted","item","renderItem","renderItemData"]);return delete u.sectionIndex,delete u.itemIndex,"function"==typeof u.onMouseEnter&&(u.onMouseEnter=this.onMouseEnter),"function"==typeof u.onMouseLeave&&(u.onMouseLeave=this.onMouseLeave),"function"==typeof u.onMouseDown&&(u.onMouseDown=this.onMouseDown),"function"==typeof u.onClick&&(u.onClick=this.onClick),r.default.createElement("li",c({role:"option"},u,{ref:this.storeItemReference}),o(n,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({isHighlighted:t},i)))}}])&&g(n.prototype,o),u&&g(n,u),s}(r.Component);t.default=S,b(S,"propTypes",{sectionIndex:o.default.number,isHighlighted:o.default.bool.isRequired,itemIndex:o.default.number.isRequired,item:o.default.any.isRequired,renderItem:o.default.func.isRequired,renderItemData:o.default.object.isRequired,onMouseEnter:o.default.func,onMouseLeave:o.default.func,onMouseDown:o.default.func,onClick:o.default.func})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapToAutowhateverTheme=t.defaultTheme=void 0;t.defaultTheme={container:"react-autosuggest__container",containerOpen:"react-autosuggest__container--open",input:"react-autosuggest__input",inputOpen:"react-autosuggest__input--open",inputFocused:"react-autosuggest__input--focused",suggestionsContainer:"react-autosuggest__suggestions-container",suggestionsContainerOpen:"react-autosuggest__suggestions-container--open",suggestionsList:"react-autosuggest__suggestions-list",suggestion:"react-autosuggest__suggestion",suggestionFirst:"react-autosuggest__suggestion--first",suggestionHighlighted:"react-autosuggest__suggestion--highlighted",sectionContainer:"react-autosuggest__section-container",sectionContainerFirst:"react-autosuggest__section-container--first",sectionTitle:"react-autosuggest__section-title"};t.mapToAutowhateverTheme=function(e){var t={};for(var n in e)switch(n){case"suggestionsContainer":t.itemsContainer=e[n];break;case"suggestionsContainerOpen":t.itemsContainerOpen=e[n];break;case"suggestion":t.item=e[n];break;case"suggestionFirst":t.itemFirst=e[n];break;case"suggestionHighlighted":t.itemHighlighted=e[n];break;case"suggestionsList":t.itemsList=e[n];break;default:t[n]=e[n]}return t}},function(e,t,n){var r=n(69),o=n(70),i=n(71),u=n(21),a=n(72),s=Math.max;e.exports=function(e){if(!e||!e.length)return[];var t=0;return e=r(e,(function(e){if(a(e))return t=s(e.length,t),!0})),u(t,(function(t){return o(e,i(t))}))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var u=e[n];t(u,n,e)&&(i[o++]=u)}return i}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(11),o=n(8);e.exports=function(e){return o(e)&&r(e)}},,,function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(4),i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function u(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),u=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}var p=n(1),g=n.n(p);function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=t.slice(0,-1),i=t[t.length-1],u=g.a.map(i,(function(t){var n=t.fields[0],i=t.fields[1],u=e.apply(void 0,f(o,[n.values.toArray(),i.values.toArray()])),s=a(a({},n),{values:new r.ArrayVector(u.times)}),c=a(a({},i),{values:new r.ArrayVector(u.values)});return new r.MutableDataFrame(a(a({},t),{fields:[s,c]}))}));return u}var h={avg:function(e){return g.a.meanBy(e,(function(e){return e}))},min:function(e){return g.a.minBy(e,(function(e){return e}))},max:function(e){return g.a.maxBy(e,(function(e){return e}))},sum:function(e){return g.a.sumBy(e,(function(e){return e}))},absoluteMin:function(e){var t=g.a.minBy(e,(function(e){return Math.abs(e)}));return void 0===t?t:Math.abs(t)},absoluteMax:function(e){var t=g.a.maxBy(e,(function(e){return Math.abs(e)}));return void 0===t?t:Math.abs(t)}};function m(e,t,n,r){var o=h[n],i=g.a.sortBy(r,(function(e){return o(e.fields[1].values.toArray())}));return"bottom"===e?g.a.slice(i,0,t):g.a.reverse(g.a.slice(i,-t))}var y={scale:g.a.partial(d,(function(e,t,n){return{times:t,values:g.a.map(n,(function(t){return t*e}))}})),offset:g.a.partial(d,(function(e,t,n){return{times:t,values:g.a.map(n,(function(t){return t+e}))}})),delta:g.a.partial(d,(function(e,t){for(var n=[],r=[],o=1;o<t.length;o+=1){var i=t[o]-t[o-1];n.push(e[o]),r.push(i)}return{times:n,values:r}})),fluctuation:g.a.partial(d,(function(e,t){for(var n=[],r=0;r<t.length;r+=1){var o=t[r]-t[0];n.push(o)}return{times:e,values:n}})),top:g.a.partial(m,"top"),bottom:g.a.partial(m,"bottom"),exclude:function(e,t){var n=new RegExp(e);return g.a.filter(t,(function(e){var t=e.fields[1],o=Object(r.getFieldDisplayName)(t,e);return!n.test(o)}))}},v={get aaFunctions(){return y}},b={},S={Transform:[],"Filter Series":[],Options:[]};function w(e){var t=a({},e);t.params=t.params||[],t.defaultParams=t.defaultParams||[],t.category&&S[t.category].push(t),b[t.name]=t,b[t.shortName||t.name]=t}w({name:"scale",category:"Transform",params:[{name:"factor",type:"float"}],defaultParams:["100"]}),w({name:"offset",category:"Transform",params:[{name:"delta",type:"float"}],defaultParams:["100"]}),w({name:"delta",category:"Transform",params:[],defaultParams:[]}),w({name:"fluctuation",category:"Transform",params:[],defaultParams:[]}),w({name:"top",category:"Filter Series",params:[{name:"number",type:"int"},{name:"value",type:"string",options:["avg","min","max","absoluteMin","absoluteMax","sum"]}],defaultParams:["5","avg"]}),w({name:"bottom",category:"Filter Series",params:[{name:"number",type:"int"},{name:"value",type:"string",options:["avg","min","max","absoluteMin","absoluteMax","sum"]}],defaultParams:["5","avg"]}),w({name:"exclude",category:"Filter Series",params:[{name:"pattern",type:"string"}],defaultParams:[""]}),w({name:"maxNumPVs",category:"Options",params:[{name:"number",type:"int"}],defaultParams:["100"]}),w({name:"binInterval",category:"Options",params:[{name:"interval",type:"int"}],defaultParams:["900"]});var O=function(){function e(e,t){this.text="",this.def=e,t?this.params=t:(this.params=[],this.params=e.defaultParams.slice(0)),this.updateText()}return e.prototype.bindFunction=function(e){var t=e[this.def.name];if(!t)throw new Error("Method not found "+this.def.name);for(var n,r=t,o=0;o<this.params.length;o+=1)n=this.params[o],"int"!==this.def.params[o].type&&"float"!==this.def.params[o].type||(n=Number(n)),r=g.a.partial(r,n);return r},e.prototype.render=function(e){var t=this,n=this.def.name+"(",r=g.a.map(this.params,(function(e,n){var r=t.def.params[n].type;return"int"===r||"float"===r||"value_or_series"===r||"boolean"===r||"int_or_interval"===r&&$.isNumeric(e)?e:"'"+e+"'"}));return e&&r.unshift(e),""+n+r.join(", ")+")"},e.prototype._hasMultipleParamsInString=function(e,t){return-1!==e.indexOf(",")&&this.def.params[t+1]},e.prototype.updateParam=function(e,t){var n=this;this._hasMultipleParamsInString(e,t)?g.a.each(e.split(","),(function(e,t){n.updateParam(e.trim(),t)})):(""===e?this.params.splice(t,1):this.params[t]=e,this.updateText())},e.prototype.updateText=function(){if(0!==this.params.length){var e=this.def.name+"("+this.params.join(", ")+")";this.text=e}else this.text=this.def.name+"()"},e}();function P(e,t){if(g.a.isString(e)){if(!b[e])throw new Error("Method not found "+e.name);return new O(b[e],t)}return new O(e,t)}function j(){return S}var x={target:"",alias:"",operator:"",regex:!1,aliasPattern:"",functions:[]},I=["firstSample","lastSample","firstFill","lastFill","mean","min","max","count","ncount","nth","median","std","jitter","ignoreflyers","flyers","variance","popvariance","kurtosis","skewness","raw"],C=function(e){function t(t){var n=e.call(this,t)||this;return n.url=t.url,n.name=t.name,n.withCredentials=t.withCredentials,n.headers={"Content-Type":"application/json"},"string"==typeof t.basicAuth&&t.basicAuth.length>0&&(n.headers.Authorization=t.basicAuth),n}return u(t,e),t.prototype.query=function(e){return s(this,void 0,Promise,(function(){var t,n,r,o=this;return c(this,(function(i){return t=this.buildQueryParameters(e),(n=g.a.filter(t,(function(e){return!e.hide}))).length<=0?[2,Promise.resolve({data:[]})]:(r=g.a.map(n,(function(e){return o.targetProcess(e)})),[2,Promise.all(r).then((function(e){return o.postProcess(e)}))])}))}))},t.prototype.targetProcess=function(e){var t=this;return this.buildUrls(e).then((function(e){return t.doMultiUrlRequests(e)})).then((function(e){return t.responseParse(e)})).then((function(n){return t.setAlias(n,e)})).then((function(n){return t.applyFunctions(n,e)}))},t.prototype.postProcess=function(e){return{data:g.a.flatten(e)}},t.prototype.buildUrls=function(e){var t=this,n=Number(e.options.maxNumPVs)||100,r=e.options.binInterval||e.interval,o=this.parseTargetPV(e.target),i=g.a.map(o,(function(r){return e.regex?t.pvNamesFindQuery(r,n):Promise.resolve([r])}));return Promise.all(i).then((function(o){return new Promise((function(i,u){var a,s=g.a.slice(g.a.uniq(g.a.flatten(o)),0,n);try{a=g.a.map(s,(function(n){return t.buildUrl(n,e.operator,r,e.from,e.to)}))}catch(e){u(e)}i(a)}))}))},t.prototype.buildUrl=function(e,t,n,r,o){var i=function(){if("raw"===t||""===n)return""+e;if(g.a.includes(["",void 0],t))return"mean_"+n+"("+e+")";if(g.a.includes(I,t))return t+"_"+n+"("+e+")";throw new Error("Data Processing Operator is invalid.")}();return this.url+"/data/getData.json?pv="+encodeURIComponent(i)+"&from="+r.toISOString()+"&to="+o.toISOString()},t.prototype.doMultiUrlRequests=function(e){var t=this,n=g.a.map(e,(function(e){return t.doRequest({url:e,method:"GET"})}));return Promise.all(n)},t.prototype.responseParse=function(e){var t=g.a.map(e,(function(e){return g.a.map(e.data,(function(e){var t=g.a.map(e.data,(function(e){return e.val})),n=g.a.map(e.data,(function(e){return 1e3*e.secs+g.a.floor(e.nanos/1e6)}));return new r.MutableDataFrame({fields:[{name:"time",type:r.FieldType.time,values:n},{name:"value",type:r.FieldType.number,values:t,config:{displayName:e.meta.name}}]})}))}));return Promise.resolve(g.a.flatten(t))},t.prototype.setAlias=function(e,t){return s(this,void 0,Promise,(function(){var n,o;return c(this,(function(i){return t.alias?(t.aliasPattern&&(n=new RegExp(t.aliasPattern,"")),o=g.a.map(e,(function(e){var o=t.alias,i=e.fields[1],u=Object(r.getFieldDisplayName)(i,e);n&&(o=u.replace(n,o));var s=a(a({},i),{config:a(a({},i.config),{displayName:o}),state:a(a({},i.state),{displayName:o})});return new r.MutableDataFrame(a(a({},e),{fields:[e.fields[0],s]}))})),[2,Promise.resolve(o)]):[2,Promise.resolve(e)]}))}))},t.prototype.applyFunctions=function(e,t){return void 0===t.functions?Promise.resolve(e):this.applyFunctionDefs(t.functions,["Transform","Filter Series"],e)},t.prototype.testDatasource=function(){return s(this,void 0,void 0,(function(){return c(this,(function(e){return[2,{status:"success",message:"Data source is working",title:"Success"}]}))}))},t.prototype.pvNamesFindQuery=function(e,t){if(!e)return Promise.resolve([]);var n=this.url+"/bpl/getMatchingPVs?limit="+t+"&regex="+encodeURIComponent(e);return this.doRequest({url:n,method:"GET"}).then((function(e){return e.data}))},t.prototype.metricFindQuery=function(e){var t=this,n=l(Object(o.getTemplateSrv)().replace(e,void 0,"regex").split("?",2),2),r=n[0],i=n[1],u=this.parseTargetPV(r),a=100;if(i){var s=new URLSearchParams(i).get("limit");if(s){var c=parseInt(s,10);a=Number.isInteger(c)?c:100}}var f=g.a.map(u,(function(e){return t.pvNamesFindQuery(e,a)}));return Promise.all(f).then((function(e){var t=g.a.slice(g.a.uniq(g.a.flatten(e)),0,a);return g.a.map(t,(function(e){return{text:e}}))}))},t.prototype.doRequest=function(e){var t=a({},e);return t.withCredentials=this.withCredentials,t.headers=this.headers,Object(o.getBackendSrv)().datasourceRequest(t)},t.prototype.buildQueryParameters=function(e){var t=this,n=Object(o.getTemplateSrv)(),r=a({},e);if(r.targets=g.a.filter(r.targets,(function(e){return""!==e.target&&void 0!==e.target})),r.targets.length<=0)return[];var i=new Date(String(r.range.from)),u=new Date(String(r.range.to)),s=u.getTime()-i.getTime(),c=r.maxDataPoints||2e3,l=g.a.floor(s/(1e3*c)),f=l>=1?String(l):"";return g.a.map(r.targets,(function(e){var o=g.a.map(e.functions,(function(e){var t=e;return t.params=g.a.map(t.params,(function(e){return n.replace(e,r.scopedVars,"regex")})),t}));return{target:n.replace(e.target,r.scopedVars,"regex"),refId:e.refId,hide:e.hide,alias:n.replace(e.alias,r.scopedVars,"regex"),operator:n.replace(e.operator,r.scopedVars,"regex"),functions:o,regex:e.regex,aliasPattern:e.aliasPattern,options:t.getOptions(e.functions),from:i,to:u,interval:f}}))},t.prototype.parseTargetPV=function(e){var t=g.a.split(e,/(\(.*?\))/),n=[""];return g.a.forEach(t,(function(e,t){if(t%2!=0){var r=g.a.split(g.a.trim(e,"()"),"|"),o=g.a.map(n,(function(e){return g.a.map(r,(function(t){return""+e+t}))}));n=g.a.flatten(o)}else n=g.a.map(n,(function(t){return""+t+e}))})),n},t.prototype.applyFunctionDefs=function(e,t,n){var r=this.pickFuncDefsFromCategories(e,t);return g.a.reduce(r,(function(e,t){return e.then((function(e){var n=P(t.def,t.params).bindFunction(v.aaFunctions);return Promise.resolve(n(e))}))}),Promise.resolve(n))},t.prototype.getOptions=function(e){var t=this.pickFuncDefsFromCategories(e,["Options"]);return g.a.reduce(t,(function(e,t){var n;return n=l(t.params,1),e[t.def.name]=n[0],e}),{})},t.prototype.pickFuncDefsFromCategories=function(e,t){var n=j(),r=g.a.reduce(t,(function(e,t){return g.a.concat(e,g.a.map(n[t],"name"))}),[]);return g.a.filter(e,(function(e){return g.a.includes(r,e.def.name)}))},t}(r.DataSourceApi),_=n(23),R=n.n(_),E=n(0),k=n.n(E),D=n(2),F=n(6),M=n.n(F),T=function(e){return e.description?k.a.createElement("span",{className:"pointer fa fa-question-circle",onClick:e.onDescriptionShow}):k.a.createElement("span",{className:"pointer fa fa-question-circle",onClick:function(){window.open("https://sasaki77.github.io/archiverappliance-datasource/functions.html#"+e.name,"_blank")}})},q=function(e){var t=e.func,n=e.index,r=e.onMoveLeft,o=e.onMoveRight,i=e.onRemove,u=e.onDescriptionShow;return k.a.createElement("div",{style:{display:"flex",width:"60px",justifyContent:"space-between"}},k.a.createElement("span",{className:"pointer fa fa-arrow-left",onClick:function(){return r(t,n)}}),k.a.createElement(T,{name:t.def.name,description:t.def.description,onDescriptionShow:u}),k.a.createElement("span",{className:"pointer fa fa-remove",onClick:function(){return i(t,n)}}),k.a.createElement("span",{className:"pointer fa fa-arrow-right",onClick:function(){return o(t,n)}}))},A=function(e){function t(t){var n=e.call(this,t)||this;return n.triggerRef=k.a.createRef(),n.renderContent=function(e){var t=e.updatePopperPosition,r=n.props,o=r.onMoveLeft,i=r.onMoveRight,u=r.func.def,s=u.name,c=u.description;return n.state.showingDescription?k.a.createElement("div",{style:{overflow:"auto",maxHeight:"30rem",textAlign:"left",fontWeight:"normal"}},k.a.createElement("h4",{style:{color:"white"}}," ",s," "),k.a.createElement("div",null,c)):k.a.createElement(q,a({},n.props,{onMoveLeft:function(){o(n.props.func,n.props.index),t()},onMoveRight:function(){i(n.props.func,n.props.index),t()},onDescriptionShow:function(){n.setState({showingDescription:!0},(function(){t()}))}}))},n.state={showingDescription:!1},n}return u(t,e),t.prototype.render=function(){var e=this;return k.a.createElement(D.PopoverController,{content:this.renderContent,placement:"top",hideAfter:300},(function(t,n,r){return k.a.createElement(k.a.Fragment,null,e.triggerRef&&k.a.createElement(D.Popover,a({},r,{referenceElement:e.triggerRef.current||void 0,wrapperClassName:"popper",className:"popper__background",onMouseLeave:function(){e.setState({showingDescription:!1}),n()},onMouseEnter:t,renderArrow:function(e){var t=e.arrowProps,n=e.placement;return k.a.createElement("div",a({className:"popper__arrow","data-placement":n},t))}})),k.a.createElement("span",{ref:e.triggerRef,onClick:r.show?n:t,onMouseLeave:function(){n(),e.setState({showingDescription:!1})},style:{cursor:"pointer"}},e.props.func.def.name))}))},t}(k.a.PureComponent),N=n(24),V=n.n(N),H=function(e){return e},U=function(e){return k.a.createElement("span",null,e)},B=function(e){function t(t){var n=e.call(this,t)||this;return n.state={suggestions:[],focused:!1},n.onChange=function(e,t,r){var o=r.newValue;n.props.onChange(e,String(o))},n.onKeydownEnter=function(e){13===e.keyCode&&e.currentTarget.blur()},n.onPVSuggestionsFetchRequested=function(e,t){e.value;var r=void 0===t?[]:t;n.setState({suggestions:r})},n.onPVSuggestionsClearRequested=function(){n.setState({suggestions:[]})},n.onSuggestionsSelected=function(e,t){t.suggestion,t.suggestionValue,t.suggestionIndex,t.sectionIndex;"enter"===t.method&&e.currentTarget.blur()},n.onFocus=function(e){n.setState({focused:!0})},n.onBlur=function(e){var t=n.props.onRunQuery;n.setState({focused:!1}),t()},n.calcInputWidth=function(e,t,n){if(e)return"90px";var r=t.length;return r<1?n.length+"ch":r+"ch"},n}return u(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.suggestions,r=t.focused,o=this.props,i=o.param,u=o.paramDef,a=o.index,s=this.calcInputWidth(r,i,u.name);return k.a.createElement("div",{className:"aa-func-param"},k.a.createElement(M.a,{suggestions:n,onSuggestionsFetchRequested:function(t){return e.onPVSuggestionsFetchRequested(t,u.options)},onSuggestionsClearRequested:this.onPVSuggestionsClearRequested,onSuggestionSelected:this.onSuggestionsSelected,getSuggestionValue:H,renderSuggestion:U,inputProps:{value:i,className:"tight-form-func-param",placeholder:u?u.name:"",spellCheck:!1,onChange:function(t,n){return e.onChange(a,t,n)},onBlur:this.onBlur,onKeyDown:this.onKeydownEnter,onFocus:this.onFocus,style:{width:s,fontFamily:'Consolas, "Courier New", Courier, Monaco, monospace'}}}))},t}(k.a.PureComponent),L=function(e){function t(t){var n=e.call(this,t)||this;return n.onParamChange=function(e,t){var r=n.props,o=r.func,i=r.index,u=f(o.params);u.splice(e,1,t);var s=a(a({},o),{params:u});n.props.onChange(s,i)},n}return u(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.func,r=t.onRunQuery,o=n.params,i=n.def,u=V()(o,i.params);return k.a.createElement(k.a.Fragment,null,u&&u.map((function(t,n){var o=l(t,2),i=o[0],u=o[1];if(void 0!==i&&void 0!==u)return k.a.createElement(k.a.Fragment,{key:u.name},n>0?k.a.createElement("span",{className:"comma"},","):"",k.a.createElement("div",null,k.a.createElement(B,{param:i,paramDef:u,index:n,onRunQuery:r,onChange:e.onParamChange})))})))},t}(k.a.PureComponent),Q=function(e){function t(t){return e.call(this,t)||this}return u(t,e),t.prototype.render=function(){var e=this.props,t=e.onMoveLeft,n=e.onMoveRight,r=e.onRemove,o=e.func,i=e.index,u=e.onChange,a=e.onRunQuery;return k.a.createElement("span",{className:"gf-form-label query-part"},k.a.createElement(A,{func:o,index:i,onMoveLeft:t,onMoveRight:n,onRemove:r}),k.a.createElement("span",null,"("),k.a.createElement(L,{func:o,index:i,onChange:u,onRunQuery:a}),k.a.createElement("span",null,")"))},t}(k.a.PureComponent),K=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=function(e,t){e.length<2||n.props.addFunc(e[1])},n}return u(t,e),t.prototype.render=function(){var e=function(e){return Object(p.reduce)(e,(function(e,t,n){var r=[];return Object(p.each)(t,(function(e){return r.push({label:e.name,value:e})})),e.push({label:n,value:n,children:r}),e}),[])}(j());return k.a.createElement(D.ButtonCascader,{options:e,value:void 0,onChange:this.onChange},"Add")},t}(k.a.PureComponent),W=function(e,t,n){var r=f(e),o=r.splice(t,1)[0];return r.splice(n,0,o),r},G=function(e){function t(t){var n=e.call(this,t)||this;return n.addFunction=function(e){var t=n.props,r=t.onChange,o=t.onRunQuery,i=P(e,e.defaultParams),u=f(n.props.funcs);u.push(i),r(u),(i.params.length||0===i.def.params.length)&&o()},n.handleRemoveFunction=function(e,t){var r=n.props,o=r.onChange,i=r.onRunQuery,u=f(n.props.funcs);u.splice(t,1),o(u),i()},n.handleMoveLeft=function(e,t){if(!(t<1)){var r=n.props,o=r.onChange,i=r.onRunQuery;o(W(n.props.funcs,t,t-1)),i()}},n.handleMoveRight=function(e,t){if(!(t>=n.props.funcs.length-1)){var r=n.props,o=r.onChange,i=r.onRunQuery;o(W(n.props.funcs,t,t+1)),i()}},n.onFuncChange=function(e,t){var r=n.props.onChange,o=f(n.props.funcs);o.splice(t,1,e),r(o)},n}return u(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.funcs,r=t.onRunQuery;return k.a.createElement("div",{className:"gf-form-inline"},k.a.createElement("div",{className:"gf-form"},k.a.createElement(D.InlineFormLabel,{width:6,className:"query-keyword"},"Functions")),k.a.createElement("div",{className:"gf-form"},n&&n.map((function(t,n){return k.a.createElement(Q,{key:n,index:n,func:t,onMoveLeft:e.handleMoveLeft,onMoveRight:e.handleMoveRight,onRemove:e.handleRemoveFunction,onChange:e.onFuncChange,onRunQuery:r})}))),k.a.createElement("div",{className:"gf-form"},k.a.createElement(K,{addFunc:this.addFunction})),k.a.createElement("div",{className:"gf-form gf-form--grow"},k.a.createElement("div",{className:"gf-form-label gf-form-label--grow"})))},t}(k.a.PureComponent),z=function(e){return e},Y=function(e){return k.a.createElement("span",null,e)},J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={pvSuggestions:[],oprSuggestions:[]},t.onPVChange=function(e,n){var r=n.newValue,o=t.props,i=o.onChange,u=o.query;i(a(a({},u),{target:r}))},t.onRegexChange=function(e){var n=t.props,r=n.onChange,o=n.onRunQuery,i=n.query;r(a(a({},i),{regex:!i.regex})),o()},t.onOperatorChange=function(e,n){var r=n.newValue,o=t.props,i=o.onChange,u=o.query;i(a(a({},u),{operator:r}))},t.onAliasChange=function(e){var n=t.props,r=n.onChange,o=n.query;r(a(a({},o),{alias:e.target.value}))},t.onAliaspatternChange=function(e){var n=t.props,r=n.onChange,o=n.query;r(a(a({},o),{aliasPattern:e.target.value}))},t.onFuncsChange=function(e){var n=t.props,r=n.onChange,o=n.query;r(a(a({},o),{functions:e}))},t.onKeydownEnter=function(e){13===e.keyCode&&e.currentTarget.blur()},t.onPVSuggestionsFetchRequested=function(e){var n=e.value;t.loadPVSuggestions(n)},t.onPVSuggestionsClearRequested=function(){t.setState({pvSuggestions:[]})},t.onOprSuggestionsFetchRequested=function(e){var n=e.value.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(".*"+n,"i"),o=I.filter((function(e){return r.test(e)}));t.setState({oprSuggestions:o})},t.onOprSuggestionsClearRequested=function(){t.setState({oprSuggestions:[]})},t.onSuggestionsSelected=function(e,t){t.suggestion,t.suggestionValue,t.suggestionIndex,t.sectionIndex;"enter"===t.method&&e.currentTarget.blur()},t}return u(t,e),t.prototype.loadPVSuggestions=function(e){var t=this,n=Object(o.getTemplateSrv)().replace(e,void 0,"regex"),r=this.props.query.regex?n:".*"+n+".*";this.props.datasource.pvNamesFindQuery(r,100).then((function(e){t.setState({pvSuggestions:e})}))},t.prototype.render=function(){var e=R()(this.props.query,x),t=this.state,n=t.pvSuggestions,r=t.oprSuggestions,o=this.props.onRunQuery,i=e.regex?{color:"#d69e2e"}:{},u=e.aliasPattern?{color:"#d69e2e"}:{};return k.a.createElement(k.a.Fragment,null,k.a.createElement("div",{className:"gf-form-inline"},k.a.createElement(D.InlineFormLabel,{width:6,className:"query-keyword"},"PV"),k.a.createElement("div",{className:"max-width-30",style:{marginRight:"4px"}},k.a.createElement(M.a,{suggestions:n,onSuggestionsFetchRequested:this.onPVSuggestionsFetchRequested,onSuggestionsClearRequested:this.onPVSuggestionsClearRequested,getSuggestionValue:z,onSuggestionSelected:this.onSuggestionsSelected,renderSuggestion:Y,shouldRenderSuggestions:function(){return!0},inputProps:{value:e.target,className:"gf-form-input",placeholder:"PV name",spellCheck:!1,style:i,onChange:this.onPVChange,onBlur:o,onKeyDown:this.onKeydownEnter}})),k.a.createElement(D.LegacyForms.Switch,{checked:e.regex,label:"Regex",labelClass:"width-6  query-keyword",onChange:this.onRegexChange})),k.a.createElement("div",{className:"gf-form"},k.a.createElement(D.InlineFormLabel,{width:6,className:"query-keyword"},"Operator"),k.a.createElement("div",{className:"max-width-30"},k.a.createElement(M.a,{suggestions:r,onSuggestionsFetchRequested:this.onOprSuggestionsFetchRequested,onSuggestionsClearRequested:this.onOprSuggestionsClearRequested,onSuggestionSelected:this.onSuggestionsSelected,getSuggestionValue:z,renderSuggestion:Y,shouldRenderSuggestions:function(){return!0},inputProps:{value:e.operator,className:"gf-form-input",placeholder:"mean",spellCheck:!1,onChange:this.onOperatorChange,onBlur:o,onKeyDown:this.onKeydownEnter}}))),k.a.createElement("div",{className:"gf-form"},k.a.createElement(D.InlineFormLabel,{width:6,className:"query-keyword"},"Alias"),k.a.createElement("input",{type:"text",value:e.alias,className:"gf-form-input max-width-30",placeholder:"Alias",style:u,onChange:this.onAliasChange,onBlur:o,onKeyDown:this.onKeydownEnter}),k.a.createElement(D.InlineFormLabel,{width:6,className:"query-keyword"},"Alias pattern"),k.a.createElement("input",{type:"text",value:e.aliasPattern,className:"gf-form-input max-width-30",placeholder:"Alias regex pattern",style:{color:"#d69e2e"},onChange:this.onAliaspatternChange,onBlur:o,onKeyDown:this.onKeydownEnter})),k.a.createElement(G,{funcs:e.functions,onChange:this.onFuncsChange,onRunQuery:o}))},t}(E.PureComponent),X=function(e){function t(t){return e.call(this,t)||this}return u(t,e),t.prototype.render=function(){var e=this.props,t=e.options,n=e.onOptionsChange;return k.a.createElement(k.a.Fragment,null,k.a.createElement(D.DataSourceHttpSettings,{defaultUrl:"http://localhost:17668/retrieval",dataSourceConfig:t,onChange:n}))},t}(E.PureComponent);n.d(t,"plugin",(function(){return Z})),Object(o.loadPluginCss)({dark:"plugins/sasaki77-archiverappliance-datasource/styles/dark.css",light:"plugins/sasaki77-archiverappliance-datasource/styles/light.css"});var Z=new r.DataSourcePlugin(C).setConfigEditor(X).setQueryEditor(J)}])}));
//# sourceMappingURL=module.js.map